@model IsolateDispatchReportViewModel
@{
	ViewData["Title"] = "Isolate Dispatch Report | Virus Isolates Repository";
}
<div class="contentbox">
	<div class="contentbox_title">Report Criteria</div>
	<div class="contentbox_body">
		<form asp-action="GenerateReport" method="post">
			<div class="pt-2">
				<div class="form-row report_date">
					<div class="minwidth-120">
						<span for="DateFrom" class="paddingLeft15">Date From</span>
					</div>
					<div class="width-50">
						<img src="~/Images/spacer.gif" width="50" height="5" alt="" />
					</div>
					<div style="flex: 1;">
						<input id="DateFrom" asp-for="DateFrom" class="width-180 " />
						@* <img src="~/Images/calendar.png" alt="calender" width="15px" height="18px" /> *@
						<span asp-validation-for="DateFrom" class="text-danger"></span>
					</div>
				</div>
				<div class="form-row report_date">
					<div class="minwidth-120">
						<span for="DateTo" class="paddingLeft15">Date To</span>
					</div>
					<div class="width-50">
						<img src="~/Images/spacer.gif" width="50" height="5" alt="" />
					</div>
					<div >
						<input id="DateTo" asp-for="DateTo" class="datepicker width-180 " />
						@* <img src="~/Images/calendar.png" alt="calender" width="15px" height="18px" /> *@
						<span asp-validation-for="DateTo" class="text-danger"></span>
					</div>
				</div>
				<div class="form-row report_date">
					<div class="paddingLeft15" style="min-width: 50px;">
						@if (Model.ReportData.Any())
						{
							<a id="RepolinkExport"
							href="@Url.Action("ExportToExcel", "Reports", new { dateFrom = Model.DateFrom, dateTo = Model.DateTo })">
								Export to Excel
							</a>
						}
						else
						{
							<a id="RepolinkExport">Export to Excel</a>
						}						
					</div>
					<div style="width: 155px;">
					</div>
					<div>
						<button type="submit" class="btn btnLink">Generate Report</button>
					</div>
				</div>
				<br />
			</div>
		</form>
	</div>
</div>

<br />

@if (Model.ReportData != null && Model.ReportData.Any())
{
	<table class="VIRtable">

		<thead>
			<tr>
				<th>AV Number</th>
				<th>Nomenclature</th>
				<th>No Of Aliquots</th>
				<th>Passage Number</th>
				<th>Recipient</th>
				<th>Recipient Name</th>
				<th>Recipient Address</th>
				<th>Reason For Dispatch</th>
				<th>Dispatched Date</th>
				<th>Dispatched By</th>
			</tr>
		</thead>
		<tbody>
			@foreach (var item in Model.ReportData)
			{
				<tr>
					<td>@item.AVNumber</td>
					<td>@item.Nomenclature</td>
					<td>@item.NoOfAliquots</td>
					<td>@item.PassageNumber</td>
					<td>@item.Recipient</td>
					<td>@item.RecipientName</td>
					<td>@item.RecipientAddress</td>
					<td>@item.ReasonForDispatch</td>
					<td>@item.DispatchedDate.ToString("d")</td>
					<td>@item.DispatchedByName</td>
				</tr>
			}
		</tbody>
	</table>
}
else
{
	<div class="no_record">
		No results to display.
	</div>
}
